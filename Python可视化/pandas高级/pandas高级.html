<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="generator" content="Aspose.Words for .NET 15.1.0.0" /><title></title></head><body><div><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">Pandas</span><span style="font-family:宋体; font-size:10.5pt">高级处理</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    缺失值处理</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    数据离散化</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    合并</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    交叉表与透视表</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    分组与聚合</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    综合案例</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">&#xa0;</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">4.6 </span><span style="font-family:宋体; font-size:10.5pt">高级处理</span><span style="font-family:Calibri; font-size:10.5pt">-</span><span style="font-family:宋体; font-size:10.5pt">缺失值处理</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    </span><span style="font-family:Calibri; font-size:10.5pt">1</span><span style="font-family:宋体; font-size:10.5pt">）如何进行缺失值处理</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">        两种思路：</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">            </span><span style="font-family:Calibri; font-size:10.5pt">1</span><span style="font-family:宋体; font-size:10.5pt">）删除含有缺失值的样本</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">            </span><span style="font-family:Calibri; font-size:10.5pt">2</span><span style="font-family:宋体; font-size:10.5pt">）替换</span><span style="font-family:Calibri; font-size:10.5pt">/</span><span style="font-family:宋体; font-size:10.5pt">插补</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">        </span><span style="font-family:Calibri; font-size:10.5pt">4.6.1 </span><span style="font-family:宋体; font-size:10.5pt">如何处理</span><span style="font-family:Calibri; font-size:10.5pt">nan</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">            1</span><span style="font-family:宋体; font-size:10.5pt">）判断数据中是否存在</span><span style="font-family:Calibri; font-size:10.5pt">NaN</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">                pd.isnull(df)</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">                pd.notnull(df)</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">            2</span><span style="font-family:宋体; font-size:10.5pt">）删除含有缺失值的样本</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">                </span><span style="font-family:Calibri; font-size:10.5pt">df.dropna(inplace=False)</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">               </span><span style="font-family:宋体; font-size:10.5pt">替换</span><span style="font-family:Calibri; font-size:10.5pt">/</span><span style="font-family:宋体; font-size:10.5pt">插补</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">                </span><span style="font-family:Calibri; font-size:10.5pt">df.fillna(value, inplace=False)</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">         4.6.2 </span><span style="font-family:宋体; font-size:10.5pt">不是缺失值</span><span style="font-family:Calibri; font-size:10.5pt">nan</span><span style="font-family:宋体; font-size:10.5pt">，有默认标记的</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">            </span><span style="font-family:Calibri; font-size:10.5pt">1</span><span style="font-family:宋体; font-size:10.5pt">）替换 ？</span><span style="font-family:Calibri; font-size:10.5pt">-&gt; np.nan</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">                df.replace(to_replace="?", value=np.nan)</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">            2</span><span style="font-family:宋体; font-size:10.5pt">）处理</span><span style="font-family:Calibri; font-size:10.5pt">np.nan</span><span style="font-family:宋体; font-size:10.5pt">缺失值的步骤</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    </span><span style="font-family:Calibri; font-size:10.5pt">2</span><span style="font-family:宋体; font-size:10.5pt">）缺失值处理实例</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">4.7 </span><span style="font-family:宋体; font-size:10.5pt">高级处理</span><span style="font-family:Calibri; font-size:10.5pt">-</span><span style="font-family:宋体; font-size:10.5pt">数据离散化</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    性别 年龄</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">A    1   23</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">B    2   30</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">C    1   18</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">    </span><span style="font-family:宋体; font-size:10.5pt">物种 毛发</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">A    1</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">B    2</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">C    3</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">    </span><span style="font-family:宋体; font-size:10.5pt">男 女 年龄</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">A   1  0  23</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">B   0  1  30</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">C   1  0  18</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">&#xa0;</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">    </span><span style="font-family:宋体; font-size:10.5pt">狗  猪  老鼠 毛发</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">A   1   0   0   2</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">B   0   1   0   1</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">C   0   0   1   1</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">one-hot</span><span style="font-family:宋体; font-size:10.5pt">编码</span><span style="font-family:Calibri; font-size:10.5pt">&amp;</span><span style="font-family:宋体; font-size:10.5pt">哑变量</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">4.7.1 </span><span style="font-family:宋体; font-size:10.5pt">什么是数据的离散化</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    原始的身高数据：</span><span style="font-family:Calibri; font-size:10.5pt">165</span><span style="font-family:宋体; font-size:10.5pt">，</span><span style="font-family:Calibri; font-size:10.5pt">174</span><span style="font-family:宋体; font-size:10.5pt">，</span><span style="font-family:Calibri; font-size:10.5pt">160</span><span style="font-family:宋体; font-size:10.5pt">，</span><span style="font-family:Calibri; font-size:10.5pt">180</span><span style="font-family:宋体; font-size:10.5pt">，</span><span style="font-family:Calibri; font-size:10.5pt">159</span><span style="font-family:宋体; font-size:10.5pt">，</span><span style="font-family:Calibri; font-size:10.5pt">163</span><span style="font-family:宋体; font-size:10.5pt">，</span><span style="font-family:Calibri; font-size:10.5pt">192</span><span style="font-family:宋体; font-size:10.5pt">，</span><span style="font-family:Calibri; font-size:10.5pt">184</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">4.7.2 </span><span style="font-family:宋体; font-size:10.5pt">为什么要离散化</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">4.7.3 </span><span style="font-family:宋体; font-size:10.5pt">如何实现数据的离散化</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    </span><span style="font-family:Calibri; font-size:10.5pt">1</span><span style="font-family:宋体; font-size:10.5pt">）分组</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">        自动分组</span><span style="font-family:Calibri; font-size:10.5pt">sr=pd.qcut(data, bins)</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">        </span><span style="font-family:宋体; font-size:10.5pt">自定义分组</span><span style="font-family:Calibri; font-size:10.5pt">sr=pd.cut(data, [])</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">    2</span><span style="font-family:宋体; font-size:10.5pt">）将分组好的结果转换成</span><span style="font-family:Calibri; font-size:10.5pt">one-hot</span><span style="font-family:宋体; font-size:10.5pt">编码</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">        </span><span style="font-family:Calibri; font-size:10.5pt">pd.get_dummies(sr, prefix=)</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">4.8 </span><span style="font-family:宋体; font-size:10.5pt">高级处理</span><span style="font-family:Calibri; font-size:10.5pt">-</span><span style="font-family:宋体; font-size:10.5pt">合并</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    </span><span style="font-family:Calibri; font-size:10.5pt">numpy</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">        np.concatnate((a, b), axis=)</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">        </span><span style="font-family:宋体; font-size:10.5pt">水平拼接</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">            </span><span style="font-family:Calibri; font-size:10.5pt">np.hstack()</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">        </span><span style="font-family:宋体; font-size:10.5pt">竖直拼接</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">            </span><span style="font-family:Calibri; font-size:10.5pt">np.vstack()</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">    1</span><span style="font-family:宋体; font-size:10.5pt">）按方向拼接</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">        </span><span style="font-family:Calibri; font-size:10.5pt">pd.concat([data1, data2], axis=1)</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">    2</span><span style="font-family:宋体; font-size:10.5pt">）按索引拼接</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">        </span><span style="font-family:Calibri; font-size:10.5pt">pd.merge</span><span style="font-family:宋体; font-size:10.5pt">实现合并</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">        </span><span style="font-family:Calibri; font-size:10.5pt">pd.merge(left, right, how="inner", on=[</span><span style="font-family:宋体; font-size:10.5pt">索引</span><span style="font-family:Calibri; font-size:10.5pt">])</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">4.9 </span><span style="font-family:宋体; font-size:10.5pt">高级处理</span><span style="font-family:Calibri; font-size:10.5pt">-</span><span style="font-family:宋体; font-size:10.5pt">交叉表与透视表</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    找到、探索两个变量之间的关系</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    </span><span style="font-family:Calibri; font-size:10.5pt">4.9.1 </span><span style="font-family:宋体; font-size:10.5pt">交叉表与透视表什么作用</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    </span><span style="font-family:Calibri; font-size:10.5pt">4.9.2 </span><span style="font-family:宋体; font-size:10.5pt">使用</span><span style="font-family:Calibri; font-size:10.5pt">crosstab(</span><span style="font-family:宋体; font-size:10.5pt">交叉表</span><span style="font-family:Calibri; font-size:10.5pt">)</span><span style="font-family:宋体; font-size:10.5pt">实现</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">        </span><span style="font-family:Calibri; font-size:10.5pt">pd.crosstab(value1, value2)</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">    4.9.3 pivot_table</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">4.10 </span><span style="font-family:宋体; font-size:10.5pt">高级处理</span><span style="font-family:Calibri; font-size:10.5pt">-</span><span style="font-family:宋体; font-size:10.5pt">分组与聚合</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    </span><span style="font-family:Calibri; font-size:10.5pt">4.10.1 </span><span style="font-family:宋体; font-size:10.5pt">什么是分组与聚合</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:10.5pt">    </span><span style="font-family:Calibri; font-size:10.5pt">4.10.2 </span><span style="font-family:宋体; font-size:10.5pt">分组与聚合</span><span style="font-family:Calibri; font-size:10.5pt">API</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">        dataframe</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">        sr</span></p><p style="font-size:10.5pt; line-height:115%; margin:0pt 0pt 10pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">&#xa0;</span></p></div><div class="cnzz" style="display: none;">
	        <script src="https://s23.cnzz.com/z_stat.php?id=1277655852&web_id=1277655852" language="JavaScript"></script>
            </div>
            <div class="docpe" style="position: absolute;color: white;margin-left:-450;">
            <a target="_blank" href="http://www.docpe.com">档铺网——在线文档免费处理</a>
            </div>
            </body></html>