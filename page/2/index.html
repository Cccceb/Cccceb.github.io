<!DOCTYPE html>


<html lang="cn" >


<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
     
  </title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
  
  

  

  <script type="text/javascript"
	src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
</head>

</html>

<body>
  <div id="app">
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/Shen-Yu/hexo-theme-ayer"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/Bg.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/"></a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>

<div id="main">
  <section class="outer">
  <article class="articles">
    
    
    
    
    <article id="post-机器学习目录" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/06/30/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%9B%AE%E5%BD%95/"
    >机器学习目录</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/06/30/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%9B%AE%E5%BD%95/" class="article-date">
  <time datetime="2020-06-30T15:22:22.267Z" itemprop="datePublished">2020-06-30</time>
</a>
      
      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h2 id="2单变量线性回归"><a class="markdownIt-Anchor" href="#2单变量线性回归"></a> <a href="/2020/06/30/2%E5%8D%95%E5%8F%98%E9%87%8F%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/">2单变量线性回归</a></h2>
<h2 id="4多维特征"><a class="markdownIt-Anchor" href="#4多维特征"></a> <a href="/2020/06/30/4%E5%A4%9A%E7%BB%B4%E7%89%B9%E5%BE%81/">4多维特征</a></h2>
<h2 id="6逻辑回归"><a class="markdownIt-Anchor" href="#6逻辑回归"></a> <a href="/2020/06/30/6%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/">6逻辑回归</a></h2>
<h2 id="8神经网络"><a class="markdownIt-Anchor" href="#8神经网络"></a> <a href="/2020/06/30/8%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/">8神经网络</a></h2>
<h2 id="9神经网络学习"><a class="markdownIt-Anchor" href="#9神经网络学习"></a> <a href="/2020/06/30/9%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/">9神经网络学习</a></h2>
<h2 id="10模型评估与选择"><a class="markdownIt-Anchor" href="#10模型评估与选择"></a> <a href="/2020/06/30/10%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E9%80%89%E6%8B%A9/">10模型评估与选择</a></h2>
<h2 id="11支撑向量机"><a class="markdownIt-Anchor" href="#11支撑向量机"></a> <a href="/2020/06/30/11%E6%94%AF%E6%92%91%E5%90%91%E9%87%8F%E6%9C%BA/">11支撑向量机</a></h2>
<h2 id="12聚类"><a class="markdownIt-Anchor" href="#12聚类"></a> <a href="/2020/06/30/12%E8%81%9A%E7%B1%BB/">12聚类</a></h2>
<h2 id="13非监督学习"><a class="markdownIt-Anchor" href="#13非监督学习"></a> <a href="/2020/06/30/13%E9%9D%9E%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0/">13非监督学习</a></h2>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hide/" rel="tag">hide</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-13非监督学习" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/06/30/13%E9%9D%9E%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0/"
    >13非监督学习</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/06/30/13%E9%9D%9E%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0/" class="article-date">
  <time datetime="2020-06-30T15:22:17.794Z" itemprop="datePublished">2020-06-30</time>
</a>
      
      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h1 id="pca"><a class="markdownIt-Anchor" href="#pca"></a> PCA</h1>
<h2 id="应用"><a class="markdownIt-Anchor" href="#应用"></a> 应用</h2>
<ol>
<li>数据表示，去线性相关</li>
<li>特征提取</li>
<li>降维去噪</li>
<li>进行可视化</li>
</ol>
<h2 id="协方差矩阵"><a class="markdownIt-Anchor" href="#协方差矩阵"></a> 协方差矩阵</h2>
<h2 id="推导"><a class="markdownIt-Anchor" href="#推导"></a> 推导</h2>
<h2 id="物理含义"><a class="markdownIt-Anchor" href="#物理含义"></a> 物理含义</h2>
<ol>
<li>大特征值对应长轴</li>
<li>小特征值对应短轴</li>
</ol>
<h1 id="lda-有监督"><a class="markdownIt-Anchor" href="#lda-有监督"></a> LDA-有监督</h1>
<ol>
<li>
<p>目标：找子空间，使数据在其中最好分</p>
</li>
<li>
<p>类内越聚集，类间距离越大，越好分</p>
</li>
<li>
<p>使用Fisher来评价</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mi>i</mi><mi>s</mi><mi>h</mi><mi>e</mi><mi>r</mi><mo>=</mo><mi>t</mi><mi>r</mi><mo stretchy="false">(</mo><msubsup><mi>S</mi><mi>w</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>S</mi><mi>b</mi></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mi>S</mi><mi>w</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>k</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>C</mi><mi>i</mi></msub><mspace linebreak="newline"></mspace><msub><mi>S</mi><mi>b</mi></msub><mo>=</mo><msub><mi>C</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">Fisher=tr(S_w^{-1}S_b)\\
S_w = \frac{1}{k}\sum_{i=1}^kC_i\\
S_b = C_b
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>所以目的变成了</p>
<p>原空间的点x,使用x=Ay变换后到新空间，他的Fisher最大，说明这个空间内最好分</p>
</li>
</ol>
<h1 id="nmf-非负矩阵分解"><a class="markdownIt-Anchor" href="#nmf-非负矩阵分解"></a> NMF 非负矩阵分解</h1>
<h2 id="作用"><a class="markdownIt-Anchor" href="#作用"></a> 作用</h2>
<ol>
<li>降维</li>
<li>特征提取</li>
<li>盲信号分离</li>
</ol>
<p>在空间中找两个基，使得基的射线能包含所有点</p>
<h1 id="ica-无监督"><a class="markdownIt-Anchor" href="#ica-无监督"></a> ICA-无监督</h1>
<h2 id="目的"><a class="markdownIt-Anchor" href="#目的"></a> 目的</h2>
<ol>
<li>
<p>找最不高斯的方向/最有结构的方向，将数据投影到这个方向上，然后在这个子空间上做聚类</p>
</li>
<li>
<p>取线性/非线性相关</p>
</li>
</ol>
<h1 id="考试"><a class="markdownIt-Anchor" href="#考试"></a> 考试</h1>
<p>线性代数</p>
<p>pdf，高斯分布，协方差矩阵，方差，给出主分量方向。LDA的方向，什么叫智力，什么是智能，什么叫机器，什么叫学习，治理怎么获得，智能怎么获得</p>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hide/" rel="tag">hide</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-11支撑向量机" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/06/30/11%E6%94%AF%E6%92%91%E5%90%91%E9%87%8F%E6%9C%BA/"
    >11支撑向量机</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/06/30/11%E6%94%AF%E6%92%91%E5%90%91%E9%87%8F%E6%9C%BA/" class="article-date">
  <time datetime="2020-06-30T15:22:17.794Z" itemprop="datePublished">2020-06-30</time>
</a>
      
      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h1 id="优化目标"><a class="markdownIt-Anchor" href="#优化目标"></a> 优化目标</h1>
<h2 id="回顾逻辑回归"><a class="markdownIt-Anchor" href="#回顾逻辑回归"></a> 回顾逻辑回归</h2>
<h3 id="目标函数"><a class="markdownIt-Anchor" href="#目标函数"></a> 目标函数</h3>
<img src="D:\MyBlog\source\MyImages\image-20200524141502856.png" alt="image-20200524141502856" style="zoom: 50%;" />
<h3 id="代价函数"><a class="markdownIt-Anchor" href="#代价函数"></a> 代价函数</h3>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>=</mo><mo>−</mo><mo stretchy="false">(</mo><mi>y</mi><mi>l</mi><mi>o</mi><mi>g</mi><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo>=</mo><mo>−</mo><mi>y</mi><mi>l</mi><mi>o</mi><mi>g</mi><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi></mrow></msup></mrow></mfrac><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi></mrow></msup></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Cost=-(ylogh_\theta (x)+(1-y)log(1-h_\theta(x)))\\
=-ylog\frac{1}{1+e^{-\theta^Tx}}-(1-y)log(1-\frac{1}{1+e^{-\theta^Tx}})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.125635em;vertical-align:-0.804195em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.279135em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.830865em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7740928571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.804195em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.125635em;vertical-align:-0.804195em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.279135em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.830865em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7740928571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.804195em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
<img src="D:\MyBlog\source\MyImages\image-20200524143056765.png" alt="image-20200524143056765" style="zoom:50%;" />
<ul>
<li>其中$$z =\theta^Tx$$</li>
</ul>
<h2 id="从逻辑回归到支持向量机"><a class="markdownIt-Anchor" href="#从逻辑回归到支持向量机"></a> 从逻辑回归到支持向量机</h2>
<h3 id="代价函数-2"><a class="markdownIt-Anchor" href="#代价函数-2"></a> 代价函数</h3>
<ul>
<li>支持向量机的代价函数是上面两个粉线合在一起</li>
</ul>
<img src="D:\MyBlog\source\MyImages\image-20200524143754612.png" alt="image-20200524143754612" style="zoom: 67%;" />
<h3 id="支撑向量机的目标函数"><a class="markdownIt-Anchor" href="#支撑向量机的目标函数"></a> <strong>支撑向量机的目标函数</strong></h3>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>C</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">[</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mi>c</mi><mi>o</mi><mi>s</mi><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mi>c</mi><mi>o</mi><mi>s</mi><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="false">(</mo><msup><mi>θ</mi><mi>T</mi></msup><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>θ</mi><mi>j</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">minC\sum_{i=1}^m[y^{(i)}cost_1(\theta^Tx^{(i)})+(1-y^{(i)})cost_0(\theta^Tx^{(i)})]+\frac{1}{2}\sum_{i=1}^n\theta_j^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-2.4530000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>其中C是一个常数</li>
</ul>
<h1 id="大边界的直观理解"><a class="markdownIt-Anchor" href="#大边界的直观理解"></a> 大边界的直观理解</h1>
<p><img src="D:\MyBlog\source\MyImages\image-20200524150614652.png" alt="image-20200524150614652" style="zoom: 50%;" /><img src="D:%5CMyBlog%5Csource%5CMyImages%5Cimage-20200524154426942.png" alt="image-20200524154426942" /><img src="D:\MyBlog\source\MyImages\image-20200524150614652.png" alt="image-20200524150614652" style="zoom: 50%;" /><img src="D:%5CMyBlog%5Csource%5CMyImages%5Cimage-20200524154426942.png" alt="image-20200524154426942" /></p>
<img src="D:\MyBlog\source\MyImages\image-20200524154433927.png" alt="image-20200524154433927" style="zoom:50%;" />
<ul>
<li>
<p>支撑向量机会选在黑线</p>
</li>
<li>
<p>两条蓝线之间的距离称为支持向量机的间距，**也是支持向量机具有鲁棒性/泛化能力强的原因。**也是因此支持向量机被称为大间距分类器</p>
</li>
<li>
<p>内积看作点在这直线上的投影长度，SVM的优化目标是令正负样本的投影点距离尽量远。</p>
</li>
<li>
<p><strong>在代价函数最小化的过程中，我们希望找出在y=1和y=0两种情况下都使得代价函数中左边的这一项尽量为零的参数。则最小化问题转换成了</strong></p>
<img src="D:\MyBlog\source\MyImages\image-20200524155248314.png" alt="image-20200524155248314"  />
</li>
<li>
<p>决策边界可能受到噪声的影响，<strong>当C不是非常大的时候，他可以忽略掉一些异常点的影响，得到更好的决策边界</strong>(C是正则化项)</p>
<ul>
<li>𝐶 较大时，相当于 𝜆 较小，可能会导致过拟合，高方差。</li>
<li>𝐶 较小时，相当于 𝜆 较大，可能会导致低拟合，高偏差。</li>
</ul>
</li>
</ul>
<h2 id="边界"><a class="markdownIt-Anchor" href="#边界"></a> 边界</h2>
<ul>
<li>边界定义为在到达数据点之前可以增加的宽度</li>
</ul>
<img src="D:\MyBlog\source\MyImages\image-20200524183922535.png" alt="image-20200524183922535" style="zoom:50%;" />
<ul>
<li>
<p>边界宽度</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mo>+</mo></msup><mo>−</mo><msup><mi>x</mi><mo>−</mo></msup><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mi>n</mi><mspace linebreak="newline"></mspace><mo>=</mo><mo stretchy="false">(</mo><msup><mi>x</mi><mo>+</mo></msup><mo>−</mo><msup><mi>x</mi><mo>−</mo></msup><mo stretchy="false">)</mo><mo separator="true">⋅</mo><mfrac><mi>w</mi><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>w</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mspace linebreak="newline"></mspace><mo>=</mo><mfrac><mn>2</mn><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>w</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">M=(x^+-x^-)·n\\
=(x^+-x^-)·\frac{w}{||w||}\\
=\frac{2}{||w||}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.071331em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.821331em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.071331em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.821331em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.071331em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.821331em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.0435600000000003em;vertical-align:-0.936em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.821331em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord">∣</span><span class="mord">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.25744em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord">∣</span><span class="mord">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li>
<p>目标是最大化M，即$$min\frac{1}{m}=min\frac{||w||^2}{2}$$</p>
<img src="D:\MyBlog\source\MyImages\image-20200524155248314.png" alt="image-20200524155248314"  />
</li>
<li>
<p><strong>这是一个凸约束情况下的凸优化问题，局部最优就是全局最优</strong></p>
</li>
</ul>
</li>
</ul>
<h1 id="核函数1"><a class="markdownIt-Anchor" href="#核函数1"></a> 核函数1</h1>
<img src="D:\MyBlog\source\MyImages\image-20200605094732882.png" alt="image-20200605094732882" style="zoom:67%;" />
<ul>
<li>三维图中，水平面坐标是x1,x2，垂直坐标轴代表f。可以看出，只有当x与l<sup>(1)</sup>重合时f才具有最大值。</li>
</ul>
<img src="D:\MyBlog\source\MyImages\image-20200605095338386.png" alt="image-20200605095338386" style="zoom:67%;" />
<ul>
<li>红色的点离l1较近，离l2,l3较远，因此f1接近1，f2,f3接近0。因此$$h=\theta_0+\theta_1f_1+\theta_2f_2+\theta_3f_3&gt;0$$，因此预测值为1</li>
<li>同理可得对于绿色的点，预测y=1</li>
<li>对于蓝色的点，因为离三个点都很远，所以y=0</li>
<li>于是就得到了分类边界(红色的线)</li>
</ul>
<h1 id="核函数2"><a class="markdownIt-Anchor" href="#核函数2"></a> 核函数2</h1>
<h2 id="如何选择地标"><a class="markdownIt-Anchor" href="#如何选择地标"></a> 如何选择地标</h2>
<ul>
<li>通常根据训练集的数量选择，m个实例选择m个地标</li>
<li>这样做的好处是，现在我们得到的新特征是建立在原有特征与训练集中所有其他特征之间距离的基础之上的</li>
</ul>
<h2 id="将核函数用于svm"><a class="markdownIt-Anchor" href="#将核函数用于svm"></a> 将核函数用于SVM</h2>
<p><img src="D:%5CMyBlog%5Csource%5CMyImages%5Cimage-20200605101608595.png" alt="image-20200605101608595" /></p>
<h3 id="修改svm假设为"><a class="markdownIt-Anchor" href="#修改svm假设为"></a> 修改SVM假设为</h3>
<p>给定𝑥，计算新特征𝑓，当$$𝜃^𝑇𝑓 &gt;= 0$$ 时，预测 𝑦 = 1，否则反之。</p>
<h3 id="修改代价函数为sum_j1nmtheta_j2thetattheta"><a class="markdownIt-Anchor" href="#修改代价函数为sum_j1nmtheta_j2thetattheta"></a> 修改代价函数为$$\sum_{j=1}<sup>{n=m}\theta_j</sup>2=\theta^T\theta$$</h3>
<p>则目标是</p>
<img src="D:\MyBlog\source\MyImages\image-20200605101818341.png" alt="image-20200605101818341" style="zoom: 67%;" />
<h2 id="svm的两个参数c和sigma"><a class="markdownIt-Anchor" href="#svm的两个参数c和sigma"></a> SVM的两个参数C和$$\sigma$$</h2>
<p>𝐶 = 1/𝜆</p>
<p>𝐶 较大时，相当于𝜆较小，可能会导致过拟合，高方差；</p>
<p>𝐶 较小时，相当于𝜆较大，可能会导致低拟合，高偏差；</p>
<p>𝜎较大时，可能会导致低方差，高偏差；</p>
<p>𝜎较小时，可能会导致低偏差，高方差。</p>
<h1 id="何时使用svm"><a class="markdownIt-Anchor" href="#何时使用svm"></a> 何时使用SVM</h1>
<p>n为特征数，m为训练样本数</p>
<p>(1)如果相较于𝑚而言，𝑛要大许多，即训练集数据量不够支持我们训练一个复杂的非线</p>
<p>性模型，我们选用逻辑回归模型或者不带核函数的支持向量机。（高维空间中的稀疏点）</p>
<p>(2)如果𝑛较小，而且𝑚大小中等，例如𝑛在 1-1000 之间，而𝑚在 10-10000 之间，使用高</p>
<p>斯核函数的支持向量机。</p>
<p>(3)如果𝑛较小，而𝑚较大，例如𝑛在 1-1000 之间，而𝑚大于 50000，则使用支持向量机会</p>
<p>非常慢，解决方案是创造、增加更多的特征，然后使用逻辑回归或不带核函数的支持向量机。</p>
<h1 id="非线性可分问题"><a class="markdownIt-Anchor" href="#非线性可分问题"></a> 非线性可分问题</h1>
<ul>
<li>引入松弛变量</li>
<li>引入核函数，因为可能在高维空间中线性可分</li>
</ul>
<h2 id="目标函数-2"><a class="markdownIt-Anchor" href="#目标函数-2"></a> 目标函数</h2>
<ul>
<li>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><msub><mi>n</mi><mi>w</mi></msub><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>w</mi><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup><mo>+</mo><mi>C</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>ζ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">min_w\frac{1}{2}||w||^2+C\sum_{i=1}^n\zeta_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07378em;">ζ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07378em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
</li>
<li>在$$y_i(w^Tx_i+b)\geq1-\zeta_i$$的条件下</li>
<li>多少个样本多少个约束</li>
</ul>
<h1 id="线代复习"><a class="markdownIt-Anchor" href="#线代复习"></a> 线代复习</h1>
<h2 id="维"><a class="markdownIt-Anchor" href="#维"></a> 维</h2>
<ul>
<li>是基中向量的个数（基是不唯一的）</li>
</ul>
<h2 id="内积"><a class="markdownIt-Anchor" href="#内积"></a> 内积</h2>
<ul>
<li>只要运算是封闭的，就可以进行内积</li>
</ul>
<h2 id="内积与相关"><a class="markdownIt-Anchor" href="#内积与相关"></a> 内积与相关</h2>
<ul>
<li>
<p>什么是正定矩阵</p>
</li>
<li>
<p>相关系数：$$p_{xy} = \frac{E_{xy}}{\sqrt{Ex<sup>2Ey</sup>2}}=\frac{E(x,y)}{\sigma_1\sigma_2}$$</p>
<p><img src="D:%5CMyBlog%5Csource%5CMyImages%5Cimage-20200605113758799.png" alt="image-20200605113758799" /></p>
</li>
</ul>
<img src="D:\MyBlog\source\MyImages\image-20200605122941604.png" alt="image-20200605122941604" style="zoom: 33%;" />
<h2 id="相关和独立"><a class="markdownIt-Anchor" href="#相关和独立"></a> 相关和独立</h2>
<ul>
<li>独立 p(x,y) = p(x)p(y),变量x和y妹有关系</li>
<li>不相关指非线性相关，不一定是独立；但是独立一定不相关</li>
</ul>
<h2 id="svm求解考么"><a class="markdownIt-Anchor" href="#svm求解考么"></a> SVM求解考么？</h2>
<h1 id="svm总结"><a class="markdownIt-Anchor" href="#svm总结"></a> SVM总结</h1>
<ul>
<li>SVM的创新之一在于将分类面的求解看作是一个二次规划问题</li>
<li>SVM的创新之二在于揭示了对分类起关键作用的只是一部分训练样本，即支持向量</li>
</ul>
<h2 id="svm特点"><a class="markdownIt-Anchor" href="#svm特点"></a> SVM特点</h2>
<img src="D:\MyBlog\source\MyImages\image-20200605130529781.png" alt="image-20200605130529781" style="zoom:50%;" />
<h2 id="不足"><a class="markdownIt-Anchor" href="#不足"></a> 不足</h2>
<img src="D:\MyBlog\source\MyImages\image-20200605130551836.png" alt="image-20200605130551836" style="zoom: 50%;" />

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hide/" rel="tag">hide</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-12聚类" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/06/30/12%E8%81%9A%E7%B1%BB/"
    >12聚类</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/06/30/12%E8%81%9A%E7%B1%BB/" class="article-date">
  <time datetime="2020-06-30T15:22:17.794Z" itemprop="datePublished">2020-06-30</time>
</a>
      
      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h1 id="聚类"><a class="markdownIt-Anchor" href="#聚类"></a> 聚类</h1>
<p><img src="/MyImages/image-20200609095208784.png" alt="image-20200609095208784" /></p>
<ol>
<li>K-Means的隐含了i)的假设，数据是高斯分布，并且每组数据的协方差矩阵都是相同的对角阵</li>
<li>改进后为EM算法</li>
</ol>
<h2 id="距离相似度"><a class="markdownIt-Anchor" href="#距离相似度"></a> 距离/相似度</h2>
<ol>
<li>欧式距离</li>
<li>闵氏距离</li>
<li>马氏距离</li>
<li>相关系数(线性关系)</li>
<li>互相关(非线性关系)</li>
<li>MIC</li>
</ol>
<p><img src="/MyImages/image-20200628210004533.png" alt="image-20200628210004533" /></p>
<ol>
<li>随着p的增大吗，图像逐渐内陷</li>
<li>距离越大，pdf越小</li>
</ol>
<h2 id="相关"><a class="markdownIt-Anchor" href="#相关"></a> 相关</h2>
<p><img src="/MyImages/image-20200609100752269.png" alt="image-20200609100752269" /></p>
<ol>
<li>相关系数关心的是角度上的差别而不是幅度上的差别，相关系数越大，夹角越小</li>
</ol>
<h1 id="pca"><a class="markdownIt-Anchor" href="#pca"></a> PCA</h1>
<ol>
<li>用处
<ol>
<li>数据表示</li>
<li>去数据中 的线性相关，从而提取特征</li>
<li>降维，进行数据压缩</li>
</ol>
</li>
</ol>
<img src="/MyImages/image-20200609104123165.png" alt="image-20200609104123165" style="zoom:50%;" />
<h1 id="nmf"><a class="markdownIt-Anchor" href="#nmf"></a> NMF</h1>
<p>用于盲信号分离</p>
<h1 id="ica"><a class="markdownIt-Anchor" href="#ica"></a> ICA</h1>
<ul>
<li>找最不高斯的方向</li>
<li></li>
</ul>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hide/" rel="tag">hide</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-10模型评估与选择" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/06/30/10%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E9%80%89%E6%8B%A9/"
    >10模型评估与选择</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/06/30/10%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E9%80%89%E6%8B%A9/" class="article-date">
  <time datetime="2020-06-30T15:22:17.779Z" itemprop="datePublished">2020-06-30</time>
</a>
      
      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h1 id="经验误差与过拟合"><a class="markdownIt-Anchor" href="#经验误差与过拟合"></a> 经验误差与过拟合</h1>
<h2 id="基本概念"><a class="markdownIt-Anchor" href="#基本概念"></a> 基本概念</h2>
<ol>
<li><strong>错误率</strong> 错误样本占样本总数的比例</li>
<li><strong>精度</strong> = 1- 错误率</li>
<li><strong>误差</strong> 机器学习的实际预测输出与样本的真实输出之间的差异称为误差</li>
<li><strong>训练误差</strong> 指学习器在训练集上的误差</li>
<li><strong>泛化误差</strong> 指在新样本上的误差</li>
<li>过拟合因素：学习能力过于强大</li>
<li>欠拟合因素：学习能力太弱，训练轮次不够</li>
</ol>
<h1 id="模型评估方法"><a class="markdownIt-Anchor" href="#模型评估方法"></a> 模型评估方法</h1>
<h2 id="留出法"><a class="markdownIt-Anchor" href="#留出法"></a> 留出法</h2>
<ol>
<li>
<p>直接讲数据集划分成两个互斥的集合，其中一个作为训练集S，另一个作为测试集T</p>
</li>
<li>
<p><strong>注意</strong> 训练集和测试集要尽可能保持数据分布的一致性。<strong>保留类别比例的采样方式称为分层采样</strong></p>
</li>
<li>
<p>在使用留出法时，<strong>一般要采用若干次随机划分</strong>，重复进行试验评估后取平均值作为留出法的评估结果。例如进行100次随即划分，每次产生一个训练/测试集用于试验评估，100次后得到100个结果，而留出法返回的则是这100个结果的平均。</p>
</li>
<li>
<p><strong>通常</strong> 将大约2/3~4/5的样本用于训练，剩余样本用于测试</p>
</li>
</ol>
<h2 id="交叉验证法"><a class="markdownIt-Anchor" href="#交叉验证法"></a> 交叉验证法</h2>
<ol>
<li>先将数据集D划分成k个大小相似的互斥子集，即D = D1∪D2∪…∪Dk。每个子集Di都尽可能保持数据分布的一致性(分层采样);然后每次用K-1个子集的并集作为训练集，1个用作测试集。得到k组结果，最终返回k组结果的均值</li>
<li>通常k折交叉验证要随机使用不同的划分重复p次，最终的评估结果是这p次k折交叉结果的均值。常见的是10次10折交叉验证</li>
<li>k通常取3，5，10，15</li>
</ol>
<h3 id="留一法"><a class="markdownIt-Anchor" href="#留一法"></a> <strong>留一法</strong></h3>
<p>若D中包含m个样本，令k=m得到的交叉验证法称为留一法。<strong>留一法不受随机样本划分方式的影响</strong></p>
<h2 id="自助法"><a class="markdownIt-Anchor" href="#自助法"></a> 自助法</h2>
<ol>
<li>
<p>以自助采样法为基础，给定包含m个样本的数据集D，然后对它进行采样产生数据集D’：<strong>每次随机从D中挑选一个样本，将其拷贝放入D’中，使得该样本在线下次采样时仍然有可能被采到</strong>，重复执行m次，得到包含m个样本的数据集D’即为自主采样的结果。</p>
</li>
<li>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C2.png" alt="" /></p>
<p>因此，初始数据集中约有36.8%的样本未出现在采样数据集中。</p>
</li>
<li>
<p><strong>优点</strong> 实际评估的模型与期望评估的模型都是用m个训练样本，而我们热能有约1/3的样本可以用于测试。<strong>适用于小的数据集</strong></p>
</li>
<li>
<p><strong>缺点</strong> 改变了原始数据集的分布，<strong>引入估计偏差</strong>。因此大数据集上还是留出法和交叉验证法更为常用</p>
</li>
</ol>
<h2 id="调参与最终模型"><a class="markdownIt-Anchor" href="#调参与最终模型"></a> 调参与最终模型</h2>
<h3 id="方法"><a class="markdownIt-Anchor" href="#方法"></a> 方法</h3>
<ol>
<li>方法时对每种参数设定取值范围和步长，</li>
</ol>
<h1 id="性能度量"><a class="markdownIt-Anchor" href="#性能度量"></a> 性能度量</h1>
<p>性能度量反应了任务需求</p>
<h2 id="回归问题"><a class="markdownIt-Anchor" href="#回归问题"></a> 回归问题</h2>
<img src="C:\Users\86139\Desktop\机器学习\md\图片\3.png" style="zoom:50%;" />
<h2 id="错误率与精度"><a class="markdownIt-Anchor" href="#错误率与精度"></a> 错误率与精度</h2>
<ol>
<li>
<p><strong>常用于分类问题</strong></p>
</li>
<li>
<p>对于数据分布D和概率密度函数p，则错误率和精度可分别定义为</p>
<img src="C:\Users\86139\Desktop\机器学习\md\图片\4.png" style="zoom:50%;" />
<img src="C:\Users\86139\Desktop\机器学习\md\图片\5.png" style="zoom:50%;" />
</li>
</ol>
<h2 id="查准率-查全率与f1"><a class="markdownIt-Anchor" href="#查准率-查全率与f1"></a> 查准率、查全率与F1</h2>
<h3 id="非类结果混淆矩阵"><a class="markdownIt-Anchor" href="#非类结果混淆矩阵"></a> 非类结果混淆矩阵</h3>
<img src="C:\Users\86139\Desktop\机器学习\md\图片\6.png" style="zoom:50%;" />
<h3 id="查准率-p-与查全率-r"><a class="markdownIt-Anchor" href="#查准率-p-与查全率-r"></a> 查准率 P 与查全率 R</h3>
<img src="C:\Users\86139\Desktop\机器学习\md\图片\7.png" style="zoom:50%;" />
<ol>
<li>查准率：正确率</li>
<li>查全率：真正例率</li>
<li><strong>是一对矛盾的度量</strong>。一般来说，查准率高时，查全率往往偏低；反之亦然。只有在一些简单任务中，才可能使查全率和查准率都很高</li>
</ol>
<h3 id="p-r曲线"><a class="markdownIt-Anchor" href="#p-r曲线"></a> P-R曲线</h3>
<img src="C:\Users\86139\Desktop\机器学习\md\图片\8.png" style="zoom: 67%;" />
<ol>
<li>根据学习器的预测结果对样例进行排序，排在前面的是学习器认为最可能是正例的样本，排在后面的则是学习器认为最不可能是正例的样本，按此顺序逐个把样本作为正例进行预测，则每次可以计算出当前的查全率，和查准率，即可绘制出P-R图</li>
<li>若一个学习器的P-R曲线被另一个完全包住，<strong>那么可断言后者优于前者</strong>。如A优于C</li>
<li>也可通过曲线下面积进行比较，但是不易判断。故提出平衡点</li>
</ol>
<h3 id="平衡点"><a class="markdownIt-Anchor" href="#平衡点"></a> 平衡点</h3>
<ol>
<li>平衡点是查准率=查全率时的取值，越大越好</li>
</ol>
<h3 id="f1度量调和平均"><a class="markdownIt-Anchor" href="#f1度量调和平均"></a> F1度量：调和平均</h3>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C9.png" alt="" /></p>
<h3 id="fβ度量"><a class="markdownIt-Anchor" href="#fβ度量"></a> Fβ度量</h3>
<p>体现了对查全率和查准率的不同偏好</p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C10.png" alt="" /></p>
<h3 id="多分类问题的度量"><a class="markdownIt-Anchor" href="#多分类问题的度量"></a> 多分类问题的度量</h3>
<p>有时，我们有多个混淆矩阵，想要估计算法的全局性能。</p>
<ol>
<li>
<p>宏查准率/查全率</p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C11.png" alt="" /></p>
</li>
<li>
<p>微查准率、微查全率、微F1</p>
<p>先计算混淆矩阵的对应元素的平均，则计算P和R，F1</p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C12.png" alt="" /></p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C13.png" alt="" /></p>
</li>
</ol>
<h2 id="roc-与-auc"><a class="markdownIt-Anchor" href="#roc-与-auc"></a> ROC 与 AUC</h2>
<h3 id="roc"><a class="markdownIt-Anchor" href="#roc"></a> ROC</h3>
<p>纵轴是真正例率TPR，横轴是假正例率FPR</p>
<img src="C:\Users\86139\Desktop\机器学习\md\图片\14.png" style="zoom:50%;" />
<ol>
<li>
<p>绘制过程</p>
<img src="C:\Users\86139\Desktop\机器学习\md\图片\15.png" style="zoom:50%;" />
</li>
</ol>
<h3 id="auc"><a class="markdownIt-Anchor" href="#auc"></a> AUC</h3>
<ol>
<li>
<p>是ROC曲线下的面积</p>
</li>
<li>
<p>估算</p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C16.png" alt="" /></p>
</li>
<li>
<p>AUC考虑的是样本预测的排序质量，它与排序误差有紧密联系。</p>
</li>
<li>
<p><strong>损失</strong></p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C17.png" alt="" /></p>
<ol>
<li>给定m+的正例和m-个反例，令D+,D-分别表示正反例集合</li>
<li><strong>解释</strong> 考虑每一对正反例，若正例的预测值小于反例，则记一个罚分，若相等，则记0.5个罚分</li>
<li>loss对应ROC曲线之上的面积</li>
</ol>
</li>
</ol>
<h3 id="多分类roc"><a class="markdownIt-Anchor" href="#多分类roc"></a> 多分类ROC</h3>
<p>一般转换成多个二分类，画多个ROC</p>
<h2 id="代价敏感错误率和代价曲线"><a class="markdownIt-Anchor" href="#代价敏感错误率和代价曲线"></a> 代价敏感错误率和代价曲线</h2>
<h3 id="代价矩阵cost"><a class="markdownIt-Anchor" href="#代价矩阵cost"></a> 代价矩阵cost</h3>
<p>以二分类为例，其中cost<sub>ij</sub>代表将第i类样本预测为第j类样本的代价。</p>
<h3 id="代价敏感的错误率非均等代价"><a class="markdownIt-Anchor" href="#代价敏感的错误率非均等代价"></a> 代价敏感的错误率(非均等代价)</h3>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C18.png" alt="" /></p>
<p><strong>带权的错误率</strong></p>
<h3 id="代价曲线"><a class="markdownIt-Anchor" href="#代价曲线"></a> 代价曲线</h3>
<p>在非均等代价下，ROC曲线不能直接反应出学习器的期望总体代价，而代价曲线可以。</p>
<ol>
<li>
<p>其横轴是取值为[0,1]的正例概率代价。其中p是样例为正例的概率</p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C19.png" alt="" /></p>
</li>
<li>
<p>其纵轴是取值为[0,1]的归一化代价</p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C20.png" alt="" /></p>
<p>FNR = 1- TPR 假负例率</p>
</li>
<li>
<p>绘制</p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C21.png" alt="" /></p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C22.png" alt="" /></p>
</li>
</ol>
<h1 id="比较检验"><a class="markdownIt-Anchor" href="#比较检验"></a> 比较检验</h1>
<ol>
<li>要综合考虑泛化能力和在测试集上的性能。</li>
<li>测试集上的性能与测试集本身的选择有很大关系</li>
<li>很多机器学习算法本身具有一定随机性，即便用相同的参数设置在同一个测试集上多次运行，其结果也会不同</li>
<li>由于以上问题，使用一些方法来为机器学习性能的比较提供依据。比如假设检验法</li>
</ol>
<h2 id="假设检验"><a class="markdownIt-Anchor" href="#假设检验"></a> 假设检验</h2>
<h3 id="假设"><a class="markdownIt-Anchor" href="#假设"></a> 假设</h3>
<ol>
<li>是对学习器泛化错误率分布的某种判断或猜想。现实中，往往根据测试错误率估推出泛化错误率的分布。</li>
</ol>
<h3 id="泛化错误率为ε的学习器被测得测试错误率为ε的概率"><a class="markdownIt-Anchor" href="#泛化错误率为ε的学习器被测得测试错误率为ε的概率"></a> 泛化错误率为ε的学习器被测得测试错误率为ε^^^的概率<img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C23.png" alt="" /></h3>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C24.png" alt="" /></p>
<ol>
<li>
<p><strong>二项检验</strong></p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C25.png" alt="" /></p>
<p>结论：</p>
<p><img src="C:%5CUsers%5C86139%5CDesktop%5C%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%5Cmd%5C%E5%9B%BE%E7%89%87%5C26.png" alt="" /></p>
</li>
<li>
<p><strong>t检验</strong> ：用于手里多个测试错误率的情况</p>
<ol>
<li>平均错误率和方差</li>
</ol>
</li>
</ol>
<h1 id="过拟合"><a class="markdownIt-Anchor" href="#过拟合"></a> 过拟合</h1>
<h2 id="将训练数据分为训练集和验证集"><a class="markdownIt-Anchor" href="#将训练数据分为训练集和验证集"></a> 将训练数据分为训练集和验证集</h2>
<img src="/MyImages/90.png" style="zoom:50%;" />
<ul>
<li>目标是在验证集上误差最小</li>
</ul>
<h1 id="评估一个假设"><a class="markdownIt-Anchor" href="#评估一个假设"></a> 评估一个假设</h1>
<ul>
<li>目的是防止过拟合</li>
<li>需要将数据分成训练集和测试集，重点是要保证数据分布一致</li>
<li>在测试集上测试模型
<ul>
<li>对于线性回归模型，利用测试集数据计算代价函数 J</li>
<li>
<img src="/MyImages/image-20200516091605630.png" alt="image-20200516091605630" style="zoom:67%;" />
</li>
</ul>
</li>
</ul>
<h1 id="模型选择和交叉验证集"><a class="markdownIt-Anchor" href="#模型选择和交叉验证集"></a> 模型选择和交叉验证集</h1>
<h2 id="模型选择的方法"><a class="markdownIt-Anchor" href="#模型选择的方法"></a> 模型选择的方法</h2>
<ul>
<li>使用训练集训练出 10 个模型</li>
<li>用 10 个模型分别对交叉验证集计算得出交叉验证误差（代价函数的值）</li>
<li>选取代价函数值最小的模型</li>
<li>用步骤 3 中选出的模型对测试集计算得出推广误差（代价函数的值）</li>
</ul>
<img src="/MyImages/image-20200516092528849.png" alt="image-20200516092528849" style="zoom:50%;" />
<h1 id="诊断偏差和方差"><a class="markdownIt-Anchor" href="#诊断偏差和方差"></a> 诊断偏差和方差</h1>
<ul>
<li>判断过拟合和欠拟合与偏差、方差的关系。</li>
</ul>
<img src="/MyImages/image-20200516093118866.png" alt="image-20200516093118866" style="zoom: 67%;" />
<ul>
<li>通常将训练集和交叉验证集的代价函数误差与多项式的次数绘制在同一张图上</li>
</ul>
<img src="/MyImages/image-20200516093354773.png" alt="image-20200516093354773" style="zoom:50%;" />
<ul>
<li>
<p>对于训练集，当 𝑑 较小时，模型拟合程度更低，误差较大；随着 𝑑 的增长，拟合程</p>
<p>度提高，误差减小。</p>
</li>
<li>
<p>对于交叉验证集，当 𝑑 较小时，模型拟合程度低，误差较大；但是随着 𝑑 的增长，</p>
<p>误差呈现先减小后增大的趋势，转折点是我们的模型开始过拟合训练数据集的时候。</p>
</li>
</ul>
<img src="/MyImages/image-20200516093446803.png" alt="image-20200516093446803" style="zoom: 50%;" />
<h2 id="判断方法"><a class="markdownIt-Anchor" href="#判断方法"></a> 判断方法</h2>
<img src="/MyImages/162bbe3ae6c8f46da4f4e05edea2d9fc_1440w.jpg" alt="img" style="zoom:50%;" />
<ul>
<li>同时结合前面方差和偏差随次数变换的情况可得结论
<ul>
<li>当训练集误差和交叉验证集误差近似时（都高）是欠拟合，有高偏差问题</li>
<li>当交叉验证集误差大于训练集误差时：是过拟合，有高方差问题。</li>
</ul>
</li>
</ul>
<h1 id="正则化和偏差方差"><a class="markdownIt-Anchor" href="#正则化和偏差方差"></a> 正则化和偏差/方差</h1>
<img src="/MyImages/image-20200516095811229.png" alt="image-20200516095811229"  />
<ul>
<li>
<p>选择λ的方法</p>
<p>1.使用训练集训练出 12 个不同程度正则化的模型</p>
<p>2.用 12 个模型分别对交叉验证集计算的出交叉验证误差</p>
<p>3.选择得出交叉验证误差<strong>最小</strong>的模型</p>
<p>4.运用步骤 3 中选出模型对测试集计算得出推广误差，我们也可以同时将训练集和交叉验证集模型的代价函数误差与 λ 的值绘制在一张图表上：</p>
</li>
</ul>
<h2 id="偏差方差-与-正则化的关系"><a class="markdownIt-Anchor" href="#偏差方差-与-正则化的关系"></a> 偏差/方差 与 正则化的关系</h2>
<p><img src="/MyImages/image-20200516102004045.png" alt="image-20200516102004045" /></p>
<ul>
<li>当 𝜆 较小时，训练集误差较小（过拟合）而交叉验证集误差较大</li>
<li>随着 𝜆 的增加，训练集误差不断增加（欠拟合），而交叉验证集误差则是先减小后增加</li>
</ul>
<h1 id="学习曲线"><a class="markdownIt-Anchor" href="#学习曲线"></a> 学习曲线</h1>
<ul>
<li>学习曲线是将训练集误差和交叉验证集误差作为训练集实例数量的函数绘制的图表</li>
</ul>
<img src="/MyImages/image-20200516102352692.png" alt="image-20200516102352692" style="zoom:80%;" />
<ul>
<li>
<img src="/MyImages/image-20200516102503027.png" alt="image-20200516102503027" style="zoom:80%;" />
* 如果用一条直线来模拟这些点，那么无论训练集有多么大误差都不会有太大改观
* **即高偏差/欠拟合的情况下，增加数据到训练集不一定有帮助**
</li>
<li>
<img src="/MyImages/image-20200516102720570.png" alt="image-20200516102720570" style="zoom: 80%;" />
* 使用非常高次的多项式来模拟，可以看出，当交叉验证集误差远大于训练集误差时，往训练集增加更多数据可以提高模型的效果。
* **即在高方差/过拟合的情况下，增加更多数据到训练集可能提高算法效果**
</li>
</ul>
<h1 id="不同情况的做法"><a class="markdownIt-Anchor" href="#不同情况的做法"></a> 不同情况的做法</h1>
<ol>
<li>
<p>获得更多的训练实例——解决高方差</p>
</li>
<li>
<p>尝试减少特征的数量——解决高方差</p>
</li>
<li>
<p>尝试获得更多的特征——解决高偏差</p>
</li>
<li>
<p>尝试增加多项式特征——解决高偏差</p>
</li>
<li>
<p>尝试减少正则化程度 λ——解决高偏差</p>
</li>
<li>
<p>尝试增加正则化程度 λ——解决高方差</p>
</li>
</ol>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hide/" rel="tag">hide</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-2单变量线性回归" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/06/30/2%E5%8D%95%E5%8F%98%E9%87%8F%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/"
    >2单变量线性回归</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/06/30/2%E5%8D%95%E5%8F%98%E9%87%8F%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/" class="article-date">
  <time datetime="2020-06-30T15:22:17.779Z" itemprop="datePublished">2020-06-30</time>
</a>
      
      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h1 id="模型表示"><a class="markdownIt-Anchor" href="#模型表示"></a> 模型表示</h1>
<h2 id="线性回归"><a class="markdownIt-Anchor" href="#线性回归"></a> 线性回归</h2>
<ol>
<li><strong>回归问题属于监督学习</strong>，是因为对于每个数据来说，我们给出了“正确的答案。</li>
<li><strong>回归</strong> 根据之前的数据预测出一个准确的输出值</li>
<li>假设我们定义h(x) = θ<sub>0</sub>+θ<sub>1</sub>x</li>
</ol>
<p><img src="/MyImages/9-1593521578763.png" alt="" /></p>
<h2 id="代价函数"><a class="markdownIt-Anchor" href="#代价函数"></a> 代价函数</h2>
<ol>
<li>
<p>问题是如何选择θ<sub>i</sub></p>
</li>
<li>
<p><strong>建模误差</strong> 我们选择的参数决定了我们得到的直线相对于我们的训练集的准确程度，模型所预测的值与训练集中实际值之间的差距（下图中蓝线所指）就是<strong>建模误差</strong>（<strong>modeling error</strong>）</p>
<p><img src="/MyImages/1-1593521580694.png" alt="" /></p>
</li>
</ol>
<h3 id="代价函数定义"><a class="markdownIt-Anchor" href="#代价函数定义"></a> 代价函数定义</h3>
<p><img src="/MyImages/2-1593521583045.png" alt="" /></p>
<p><strong>化成等高线图</strong>，三个坐标分别是θ<sub>0</sub>,θ<sub>1</sub> J(θ<sub>0</sub>,θ<sub>1</sub>)</p>
<p><img src="/MyImages/3-1593521584866.png" alt="" /></p>
<h2 id="代价函数的直观理解-i"><a class="markdownIt-Anchor" href="#代价函数的直观理解-i"></a> 代价函数的直观理解 I</h2>
<p><img src="/MyImages/4-1593521585777.png" alt="" /></p>
<ol>
<li>这是简化的代价函数</li>
<li>根据不同的θ值，可以得到不同的J，即可画出右侧的图</li>
</ol>
<h2 id="代价函数的直观理解-ii"><a class="markdownIt-Anchor" href="#代价函数的直观理解-ii"></a> 代价函数的直观理解 II</h2>
<p>通过这些图形，我希望你能更好地理解这些代价函数𝐽所表达的值是什么样的，它们对应的假设是什么样的，以及什么样的假设对应的点，更接近于代价函数𝐽的最小值</p>
<h1 id="梯度下降"><a class="markdownIt-Anchor" href="#梯度下降"></a> 梯度下降</h1>
<ol>
<li>是一种用来<strong>求函数最小值</strong>的算法</li>
</ol>
<h2 id="思想"><a class="markdownIt-Anchor" href="#思想"></a> 思想</h2>
<ol>
<li>开始时我们随机选择一个参数的组合(𝜃0, 𝜃1, . . . . . . , 𝜃𝑛)，计算代价函数，然后我们寻找下一个能让代价函数值下降最多的参数组合。</li>
<li>持续这样做直到得到一个<strong>局部最小值</strong>(因为我们并没有尝试完所有的参数组合，所以不能确定我们得到的局部最小值是否便是全局最小值（<strong>global minimum</strong>），选择不同的初始参数组合，可能会找到不同的局部最小值)</li>
</ol>
<h2 id="梯度下降-2"><a class="markdownIt-Anchor" href="#梯度下降-2"></a> 梯度下降</h2>
<p><img src="/MyImages/5-1593521588740.png" alt="" /></p>
<ol>
<li>
<p>其中<strong>α是学习率</strong>它决定了我们沿着能让代价函数下降程度最大的方向向下迈出的步子有多大</p>
</li>
<li>
<p><strong>注意</strong> 更新要同时进行</p>
<p><img src="/MyImages/6-1593521589904.png" alt="" /></p>
</li>
</ol>
<h1 id="梯度下降的直观理解"><a class="markdownIt-Anchor" href="#梯度下降的直观理解"></a> 梯度下降的直观理解</h1>
<h2 id="对求导的理解"><a class="markdownIt-Anchor" href="#对求导的理解"></a> 对求导的理解</h2>
<p><img src="/MyImages/7-1593521591534.png" alt="" /></p>
<ol>
<li>求导的目的，基本上可以说取<strong>这个红点的切线</strong>，就是这样一条红色的直线，刚好与函数相切于这一点，让我们看看这条红色直线的斜率，就是这条刚好与函数曲线 相切的这条直线，<strong>这条直线的斜率正好是这个三角形的高度除以这个水平长度</strong></li>
</ol>
<h2 id="α的影响"><a class="markdownIt-Anchor" href="#α的影响"></a> α的影响</h2>
<ol>
<li>如果𝑎太大，那么梯度下降法可能会越过最低点，甚至可能无法收敛，下一次迭代又移动了一大步，越过一次，又越过一次，一次次越过最低点，直到你发现实际上离最低点越来越远，所以，如果𝑎太大，它会导致无法收敛，甚至发散</li>
<li>如果𝑎太小了，即我的学习速率太小，结果就是只能这样像小宝宝一样一点点地挪动， 去努力接近最低点，这样就需要很多步才能到达最低点，所以如果𝑎太小的话，可能会很慢，因为它会一点点挪动，它会需要很多步才能到达全局最低点</li>
</ol>
<h3 id="α是定值即可"><a class="markdownIt-Anchor" href="#α是定值即可"></a> α是定值即可</h3>
<p>因为一直在朝着最低点走，导数项总是成下降趋势，所以θ更新的幅度也会更小。所以随着梯</p>
<p>度下降法的运行，你移动的幅度会自动变得越来越小，直到最终移动幅度非常小，你会发现，已经收敛到局部极小值。所以实际上没有必要再另外减小𝑎。</p>
<h1 id="梯度下降的线性回归"><a class="markdownIt-Anchor" href="#梯度下降的线性回归"></a> 梯度下降的线性回归</h1>
<p><img src="/MyImages/8-1593521593488.png" alt="" /></p>
<ol>
<li>即<strong>批量梯度下降</strong>，指的是在梯度下降的每一步中，我们都用到了所有的训练样本，在梯度下降中，在计算微分求导项时，我们需要进行求和运算，所以，在每一个单独的梯度下降中，我们最终都要计算这样一个东西，这个项需要对所有𝑚个训练样本求和。</li>
</ol>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hide/" rel="tag">hide</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-4多维特征" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/06/30/4%E5%A4%9A%E7%BB%B4%E7%89%B9%E5%BE%81/"
    >4多维特征</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/06/30/4%E5%A4%9A%E7%BB%B4%E7%89%B9%E5%BE%81/" class="article-date">
  <time datetime="2020-06-30T15:22:17.779Z" itemprop="datePublished">2020-06-30</time>
</a>
      
      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h1 id="多维特征"><a class="markdownIt-Anchor" href="#多维特征"></a> 多维特征</h1>
<ol>
<li><strong>多变量的假设</strong>h为</li>
</ol>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>θ</mi><mn>0</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>θ</mi><mn>3</mn></msub><msub><mi>x</mi><mn>3</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>θ</mi><mi>n</mi></msub><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msup><mi>θ</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding="application/x-tex">h_θ(x) = θ_0+θ_1x_1+θ_2x_2+θ_3x_3+...+θ_nx_n= θ^Tx
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8913309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span></span></span></span></span></p>
<h2 id="多变量梯度下降"><a class="markdownIt-Anchor" href="#多变量梯度下降"></a> 多变量梯度下降</h2>
<ol>
<li>
<p>代价函数是所有建模误差的平方和</p>
<p><img src="/MyImages/10-1593521617832.png" alt="" /></p>
</li>
<li>
<p>如果去掉平方，正负抵消，会导致目标出错。</p>
</li>
<li>
<p>如果把平方换成绝对值，但绝对值不可导</p>
</li>
<li>
<p>除二，是为了求导之后抵消掉平方的导数</p>
</li>
</ol>
<h2 id="多变量线性回归的批量梯度下降"><a class="markdownIt-Anchor" href="#多变量线性回归的批量梯度下降"></a> 多变量线性回归的批量梯度下降</h2>
<p><img src="/MyImages/11-1593521619163.png" alt="" /></p>
<p><img src="/MyImages/12-1593521621252.png" alt="" /></p>
<h1 id="梯度下降法实践-1-特征缩放"><a class="markdownIt-Anchor" href="#梯度下降法实践-1-特征缩放"></a> 梯度下降法实践 1-特征缩放</h1>
<ol>
<li>
<p>有时候，要保证这些特征具有相近的尺度，这<strong>将帮助梯度下降算法更快的收敛</strong></p>
<p><img src="/MyImages/17-1593521623434.png" alt="" /></p>
<ol>
<li>以房价问题为例，假设用两个特征，房屋的尺寸和房屋的数量的参数为何总坐标，绘制代价函数的等高线图。</li>
<li>由于房屋的尺寸和房屋的数量的值域范围差距较大，所以图像显得很扁，<strong>梯度下降算法要非常多次的迭代才能收敛</strong></li>
</ol>
</li>
<li>
<p>最简单的方法是令</p>
<p><img src="/MyImages/13-1593521625581.png" alt="" /></p>
<ol>
<li>问题在于均值受离群点影响很大</li>
</ol>
</li>
</ol>
<h1 id="梯度下降法实践-2-学习率"><a class="markdownIt-Anchor" href="#梯度下降法实践-2-学习率"></a> 梯度下降法实践 2-学习率</h1>
<h2 id="观察收敛"><a class="markdownIt-Anchor" href="#观察收敛"></a> 观察收敛</h2>
<ol>
<li>
<p>可以绘制迭代次数和代价函数的图来观测算法在何时趋于收敛</p>
<p><img src="/MyImages/16-1593521626880.png" alt="" /></p>
</li>
<li>
<p>也可以将代价函数的变化值与某个阀值,自动检测收敛</p>
</li>
</ol>
<h2 id="学习率的影响"><a class="markdownIt-Anchor" href="#学习率的影响"></a> 学习率的影响</h2>
<ol>
<li>如果学习率𝑎过小，则达到收敛所需的迭代次数会非常高；</li>
<li>如果学习率𝑎过大，每次迭代可能不会减小代价函数，可能会越过局部最小值导致无法收敛。</li>
</ol>
<h1 id="特征和多项式回归"><a class="markdownIt-Anchor" href="#特征和多项式回归"></a> 特征和多项式回归</h1>
<ol>
<li>有时线性回归并不适用于所有数据，有时需要用曲线。</li>
<li>具体的选择需要观察数据后再决定</li>
<li>可以令x = x<sup>2</sup>或x = x<sup>3</sup>将模型转为线性回归的</li>
<li>同样的，也可以令低次变成高次</li>
</ol>
<h1 id="正规方程"><a class="markdownIt-Anchor" href="#正规方程"></a> 正规方程</h1>
<ol>
<li>对于某些问题，正规方程比梯度下降法更好</li>
<li>现在已知$$xθ=y$$ 看作一个方程组，m个方程(m个样本)，n+1个位置数(n+1个θ)，假设所有方程独立
<ul>
<li>m&gt;n+1 <strong>无解</strong></li>
<li>m=n+1 θ=x<sup>-1</sup>y <strong>有唯一解</strong></li>
<li>m&lt;n+1 <strong>无穷解</strong></li>
</ul>
</li>
</ol>
<h2 id="求解"><a class="markdownIt-Anchor" href="#求解"></a> 求解</h2>
<ol>
<li>
<p>正规方程是通过求解</p>
<p><img src="/MyImages/14-1593521629310.png" alt="" />来找出使得代价函数最小的参数</p>
</li>
<li>
<p>设训练集矩阵为X，并且训练结果为向量y，则利用正规方程解出向量$$θ=(X<sup>TX)</sup>{-1}X^Ty$$</p>
</li>
<li>
<p><strong>注意 对于不可逆的矩阵(通常是因为特征之间不独立，如包含英尺为单位的尺寸，同时包含米为单位的尺寸）正规方程是不可用的</strong></p>
</li>
</ol>
<h2 id="梯度下降-正规方程"><a class="markdownIt-Anchor" href="#梯度下降-正规方程"></a> 梯度下降 &amp; 正规方程</h2>
<p><img src="/MyImages/15-1593521630662.png" alt="" /></p>
<h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2>
<ol>
<li>对于特征数量小于一万的，通常使用标准方程法</li>
<li>对于复杂的学习算法，可能不得不使用梯度下降法。可以用在有大量特征变量的线性回归问题中。</li>
</ol>
<h2 id="推导θ"><a class="markdownIt-Anchor" href="#推导θ"></a> 推导θ</h2>
<p><img src="/MyImages/57.png" alt="" /></p>
<p><img src="/MyImages/58.png" alt="" /></p>
<h2 id="最小二乘解"><a class="markdownIt-Anchor" href="#最小二乘解"></a> 最小二乘解</h2>
<ol>
<li>用于提高精度</li>
<li>解比每个测量的精度都高</li>
</ol>
<h1 id="正规方程及其不可逆性"><a class="markdownIt-Anchor" href="#正规方程及其不可逆性"></a> 正规方程及其不可逆性</h1>
<p>问题：如果$$X^TX$$不可逆怎么办</p>
<ol>
<li><strong>首先，看特征值里是否有一些多余的特征</strong>，像这些x1和x2是线性相关的，称为线性函数。同时，当有一些多余的特征时，可以删除这两个重复特征中的一个。</li>
</ol>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hide/" rel="tag">hide</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-6逻辑回归" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/06/30/6%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/"
    >6逻辑回归</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/06/30/6%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/" class="article-date">
  <time datetime="2020-06-30T15:22:17.779Z" itemprop="datePublished">2020-06-30</time>
</a>
      
      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h1 id="分类问题"><a class="markdownIt-Anchor" href="#分类问题"></a> 分类问题</h1>
<h2 id="逻辑回归"><a class="markdownIt-Anchor" href="#逻辑回归"></a> 逻辑回归</h2>
<ol>
<li><strong>逻辑回归是分类算法</strong></li>
<li>如果要预测的变量y是离散的值，那么我们将使用逻辑回归。逻辑回归的结果永远在0到1之间</li>
<li>因为如果使用线性回归，那么假设函数的输出值可能远大于1，或者远小于0。</li>
</ol>
<h2 id="感知器-逻辑回归"><a class="markdownIt-Anchor" href="#感知器-逻辑回归"></a> 感知器 &amp; 逻辑回归</h2>
<ul>
<li>激活函数不同</li>
<li>损失函数不同</li>
<li>感知器的解和起始点有关(非凸的，可能有很多解，但是对于线性可分问题，都是解)，但是逻辑回归只有唯一解</li>
</ul>
<h1 id="假说表示"><a class="markdownIt-Anchor" href="#假说表示"></a> 假说表示</h1>
<ol>
<li>
<p>其假说为$$h_θ(x)=g(θ^TX)$$ ，其中</p>
<ul>
<li>
<p>X代表特征向量</p>
</li>
<li>
<p>g代表逻辑函数</p>
<ul>
<li>
<p>一个常用的逻辑函数sigmoid</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">g(z) = \frac {1}{1+e^{-z}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.09077em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.697331em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight" style="margin-right:0.04398em;">z</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<img src="/MyImages/image-20200405131921296.png" alt="image-20200405131921296" style="zoom: 50%;" />
</li>
</ul>
</li>
<li>
<p><strong>$$h_θ(x)$$表示对于给定的输入变量，根据选择的参数计算输出变量=1的可能性，即$$h_θ(x)=P(y=1|x;θ)$$</strong></p>
</li>
</ul>
</li>
</ol>
<h1 id="判定边界"><a class="markdownIt-Anchor" href="#判定边界"></a> 判定边界</h1>
<h2 id="下决策边界"><a class="markdownIt-Anchor" href="#下决策边界"></a> 下决策边界</h2>
<p>由sigmoid函数的图像可知</p>
<ul>
<li>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><msubsup><mi>θ</mi><mi>x</mi><mi>T</mi></msubsup><mo>&gt;</mo><mo>=</mo><mn>0</mn><mi mathvariant="normal">时</mi><mi mathvariant="normal">，</mi><mi>y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">z=θ^T_x&gt;=0时，y=1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.138331em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mord cjk_fallback">时</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span></p>
</li>
<li>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><msubsup><mi>θ</mi><mi>x</mi><mi>T</mi></msubsup><mo>&lt;</mo><mn>0</mn><mi mathvariant="normal">时</mi><mi mathvariant="normal">，</mi><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">z=θ^T_x&lt;0时，y=0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.138331em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mord cjk_fallback">时</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span></p>
</li>
</ul>
<h3 id="举例"><a class="markdownIt-Anchor" href="#举例"></a> 举例</h3>
<ol>
<li>
<img src="/MyImages/image-20200405132017999.png" alt="image-20200405132017999" style="zoom:50%;" />
<p>假设参数θ是[-3 1 1] 则当$$-1+x_1+x_2&gt;=0时，即x_1+x2&gt;=3时，预测y=1，可以绘制直线x_1+x_2=3$$这条线，即为模型的分界线</p>
</li>
<li>
<img src="/MyImages/image-20200405132041615.png" alt="image-20200405132041615" style="zoom:50%;" />
<ul>
<li>这个需要用到二次方特征</li>
<li>设$$h_θ(x)=g(θ_0+θ_1x_1+θ_2x_2+θ_3x_1<sup>2+θ_4x_2</sup>2)$$</li>
<li>设θ是[-1 0 0 1 1],则判定边界恰好是圆心在原点且半径为1的圆形</li>
</ul>
</li>
</ol>
<h1 id="代价函数拟合问题"><a class="markdownIt-Anchor" href="#代价函数拟合问题"></a> 代价函数(拟合问题)</h1>
<ol>
<li>问题：如果沿用线性回归时使用的所有模型误差的平方和，那么当我们将h<sub>θ</sub>x带入时，会产生一个**非凹函数。**即代价函数有许多局部最小值，影响梯度下降算法的执行。</li>
</ol>
<h2 id="逻辑回归的代价函数"><a class="markdownIt-Anchor" href="#逻辑回归的代价函数"></a> 逻辑回归的代价函数</h2>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">J(θ) = \frac{1}{m}\sum _{i=1}^m Cost(h_θ(x^{(i)}),y^{(i)})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>其中</p>
<ol>
<li>
<p>h<sub>θ</sub>(x)与$$Cost(h_θ(x),y)$$之间的关系</p>
<img src="/MyImages/image-20200405132438997.png" alt="image-20200405132438997" style="zoom:50%;" />
<ol>
<li>
<p>可以看出</p>
<ul>
<li>当y=1时，随着h里1越远Cost值越大</li>
<li>当y=0时，随着h里0越远Cost值越大</li>
</ul>
</li>
<li>
<p>Cost可统一写成</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>y</mi><mo>×</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mo>×</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Cost(h_θ(x),y)=-y×log(h_θ(x))-(1-y)×log(1-h_θ(x))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>将上式带回J(θ)</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">[</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">J(θ)=-\frac{1}{m}\sum _{i=1}^m[y^{(i)}log(h_θ(x^{(i)}))+(1-y^{(i)})log(1-h_θ(x^{(i)}))]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.188em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cost</span><span class="params">(theta, X, y)</span>:</span></span><br><span class="line">     theta = np.matrix(theta)</span><br><span class="line">     X = np.matrix(X)</span><br><span class="line">     y = np.matrix(y)</span><br><span class="line">     first = np.multiply(-y, np.log(sigmoid(X* theta.T)))</span><br><span class="line">     second = np.multiply((<span class="number">1</span> - y), np.log(<span class="number">1</span> - sigmoid(X* theta.T)))</span><br><span class="line">     <span class="keyword">return</span> np.sum(first - second) / (len(X))</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<h2 id="梯度下降"><a class="markdownIt-Anchor" href="#梯度下降"></a> 梯度下降</h2>
<img src="/MyImages/image-20200405132513958.png" alt="image-20200405132513958" style="zoom:50%;" />
<h3 id="证明该代价函数会给我们一个凸优化问题"><a class="markdownIt-Anchor" href="#证明该代价函数会给我们一个凸优化问题"></a> 证明：该代价函数会给我们一个凸优化问题</h3>
<img src="/MyImages/image-20200405132545281.png" alt="image-20200405132545281" style="zoom:50%;" />
<h3 id="其他最下化代价函数算法"><a class="markdownIt-Anchor" href="#其他最下化代价函数算法"></a> 其他最下化代价函数算法</h3>
<p><strong>共轭梯度</strong>（<strong>Conjugate Gradient</strong>），<strong>局部优化法</strong>(<strong>Broyden</strong> <strong>fletcher goldfarb shann,BFGS</strong>)和<strong>有限内存局部优化法</strong>(<strong>LBFGS</strong>) ，<strong>fminunc</strong></p>
<h1 id="简化的成本函数和梯度下降函数"><a class="markdownIt-Anchor" href="#简化的成本函数和梯度下降函数"></a> 简化的成本函数和梯度下降函数</h1>
<ol>
<li>
<p>我们假设的输出，实际上就是这个概率值$$p(y=1|x;θ)$$,就是关于x以θ为参数，y=1的概率</p>
</li>
<li>
<p>我们的梯度下降算法可以写成</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>θ</mi><mi>j</mi></msub><mo>:</mo><mo>=</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>−</mo><mi>α</mi><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>−</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><msubsup><mi>x</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">θ_j:=θ_j-α\frac{1}{m}\sum _{i=1}^m(h_θ(x^{(i)})-y^{(i)})x_j^{(i)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-0.412972em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<ol>
<li>这是与线性回归完全不同的方法，因为我们假设的定义发生了变化，尽管二者更新参数的规则看起来相同</li>
</ol>
</li>
<li>
<p>特征缩放同样适用于逻辑回归，可以加快收敛速度。特别适用于特征范围差距很大的情况下。</p>
</li>
</ol>
<h1 id="高级优化"><a class="markdownIt-Anchor" href="#高级优化"></a> 高级优化</h1>
<p>利用一些高级优化算法和一些高级优化概念，使通过梯度下降，进行逻辑回归的素大大提高。</p>
<ol>
<li>
<p>基础梯度下降</p>
<p>输出参数θ，计算J(θ)和J关于0,1…n的偏导数</p>
<p><img src="/MyImages/image-20200405132625410.png" alt="image-20200405132625410" /></p>
<ul>
<li>例如<strong>共轭梯度法</strong> <strong>BFGS</strong> (<strong>变尺度法</strong>) 和 <strong>L-BFGS</strong> (**限制变尺度法) **</li>
<li>优点：
<ul>
<li>不需要手动选择学习率α，所以对于这些算法的一种思路是，给出计算导数项和代价函数的方法，你可以认为算法有一个智能的内部循环(称为<strong>线性搜索</strong>(<strong>line search</strong>)算法)</li>
<li>通过线内搜索算法，可以自动尝试不同的学习率，并自动选择一个好的学习率，甚至可以为每次迭代选择不同的学习率</li>
</ul>
</li>
<li>缺点：
<ul>
<li>复杂</li>
</ul>
</li>
</ul>
</li>
</ol>
<h1 id="多类别分类一样多"><a class="markdownIt-Anchor" href="#多类别分类一样多"></a> 多类别分类：一样多</h1>
<p><img src="/MyImages/image-20200405132749428.png" alt="image-20200405132749428" style="zoom:50%;" /><img src="/MyImages/image-20200405132830037.png" alt="image-20200405132830037" /></p>
<h2 id="基本思想"><a class="markdownIt-Anchor" href="#基本思想"></a> 基本思想</h2>
<ol>
<li>
<p>将一对多问题转换成多个二分类问题</p>
</li>
<li>
<p>创建一个新的“伪”训练集，将类型2和类型3都定义为负类。这样训练一个标准的逻辑回归分类器，就得到一个正边界。</p>
<p><img src="/MyImages/image-20200405132830037.png" alt="image-20200405132830037" /></p>
</li>
<li>
<p>最后得到k个分类机，记作$$h_θ^{(i)}=p(y=i|x;θ) 其中i=(1,2,3…k)$$</p>
</li>
<li>
<p>做预测时，将所有呋喃类器都运行一遍，对每一个输入变量，都选择最高可能性的输出变量。例如对于开头的三分类，我们要做的就是输入要预测的x，选择一个让$$h_θ^{(i)}(x)$$最大的i</p>
</li>
</ol>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hide/" rel="tag">hide</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-8神经网络" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/06/30/8%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"
    >8神经网络</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/06/30/8%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" class="article-date">
  <time datetime="2020-06-30T15:22:17.779Z" itemprop="datePublished">2020-06-30</time>
</a>
      
      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h1 id="非线性假设"><a class="markdownIt-Anchor" href="#非线性假设"></a> 非线性假设</h1>
<ul>
<li>由于普通的线性回归和逻辑回归不能有效的处理高维特征，所以需要神经网络</li>
<li>假设初始有2500个特征，那么如果我们要进一步将两两特征组合构成一个多项式模型，则会有$$\frac{2500^2}{2}$$个特征。</li>
</ul>
<h1 id="模型表示1"><a class="markdownIt-Anchor" href="#模型表示1"></a> 模型表示1</h1>
<h2 id="大脑中的神经网络"><a class="markdownIt-Anchor" href="#大脑中的神经网络"></a> 大脑中的神经网络</h2>
<ul>
<li>
<p>每一个神经元都可以被认为是一个处理单元/神经核（<strong>processing unit</strong>/<strong>Nucleus</strong>），它含有许多输入/树突</p>
<p>（<strong>input</strong>/<strong>Dendrite</strong>），并且有一个输出/轴突（<strong>output</strong>/<strong>Axon</strong>）。神经网络是大量神经元相互链接并通过电脉冲来交流的一个网络。</p>
</li>
</ul>
<h2 id="神经网络模型"><a class="markdownIt-Anchor" href="#神经网络模型"></a> 神经网络模型</h2>
<img src="/MyImages/image-20200406172330534.png" alt="image-20200406172330534" style="zoom:50%;" />
<ul>
<li>神经网络模型建立在很多神经元之上，每一个神经元又是一个个学习模型。这些神经元（也叫激活单元，<strong>activation unit</strong>）采纳一些特征作为输出，并且根据本身的模型提供一个输出。在神经网络中，参数又可被成为权重（<strong>weight</strong>）。</li>
</ul>
<h3 id="结构"><a class="markdownIt-Anchor" href="#结构"></a> 结构</h3>
<p><img src="/MyImages/image-20200406172647607.png" alt="image-20200406172647607" /></p>
<ul>
<li>三层分别为输入层，中间层，输出层</li>
</ul>
<h3 id="描述"><a class="markdownIt-Anchor" href="#描述"></a> 描述</h3>
<ul>
<li>
<p>可以使用权重矩阵：</p>
<p>例如𝜃(1)代表从第一层映射到第二层的权重的矩阵。其尺寸为：以第 𝑗 + 1层的激活单元数量为行数，以第 𝑗 层的激活单元数加一为列数的矩阵。例如：上图所示的神经网络中𝜃(1)的尺寸为 3*4。</p>
</li>
<li>
<p>对于上图所示的模型，激活单元和输出分别表达为：</p>
<img src="/MyImages/image-20200406173612603.png" alt="image-20200406173612603" style="zoom: 67%;" />
</li>
</ul>
<h3 id="前向传播算法"><a class="markdownIt-Anchor" href="#前向传播算法"></a> 前向传播算法</h3>
<p>每一个𝑎都是由上一层所有的𝑥和每一个𝑥所对应的权重决定的，我们把这样从左到右的算法称为前向传播算法( <strong>FORWARD PROPAGATION</strong> )。</p>
<h1 id="模型表示2"><a class="markdownIt-Anchor" href="#模型表示2"></a> 模型表示2</h1>
<ul>
<li>
<p>计算第二层</p>
<img src="/MyImages/image-20200406175334847.png" alt="image-20200406175334847" style="zoom: 80%;" />
<p>令$$z^{(2)}=\theta <sup>{(1)}x，则a</sup>{(2)}=g(z^{(2)})$$</p>
</li>
<li>
<p>添加$$a_0^{(2)}=0$$ 计算第三层</p>
<img src="/MyImages/image-20200406180531918.png" alt="image-20200406180531918" style="zoom: 67%;" />
<p>令$$z^{(3)}=\theta <sup>{(2)}a</sup>{(2)}，则h_{\theta}(x)=g(z^{(3)})$$</p>
</li>
<li>
<p>以上是针对训练集中一个训练实例进行的计算。现要对正个训练集进行计算，将训练集特征矩阵进行转置，使得同一个实例的特征在用一列中.</p>
<p>即令$$z<sup>{(2)}=\theta</sup>{(1)}×X^T$$</p>
<p>​		$$a<sup>{(2)}=g(z</sup>{(2)})$$</p>
</li>
</ul>
<h3 id="理解"><a class="markdownIt-Anchor" href="#理解"></a> 理解</h3>
<img src="/MyImages/image-20200406182621033.png" alt="image-20200406182621033" style="zoom:50%;" />
<ul>
<li>
<p>右半部分其实就是以𝑎0, 𝑎1, 𝑎2, 𝑎3, 按照 <strong>Logistic Regression</strong> 的方式输出ℎ𝜃(𝑥)：</p>
</li>
<li>
<p>其实神经网络就像是 <strong>logistic regression</strong>，只不过我们把 <strong>logistic regression</strong> 中的输入向量</p>
<p>[𝑥1 ∼ 𝑥3] 变成了中间层的$$[𝑎_1^{(2)} ∼ 𝑎_3^{(2)}]$$</p>
</li>
<li>
<p>可以把𝑎0, 𝑎1, 𝑎2, 𝑎3看成更为高级的特征值，也就是𝑥0, 𝑥1, 𝑥2, 𝑥3的进化体，并且它们是由 𝑥与决定的，因为是梯度下降的，所以𝑎是变化的.并且能更好的预测新数据</p>
</li>
</ul>
<h1 id="特征和直观理解1"><a class="markdownIt-Anchor" href="#特征和直观理解1"></a> 特征和直观理解1</h1>
<h3 id="逻辑回归-神经网络"><a class="markdownIt-Anchor" href="#逻辑回归-神经网络"></a> 逻辑回归 &amp; 神经网络</h3>
<ul>
<li>神经网络能够通过学习得出其自身的一系列特征；</li>
<li>在普通的逻辑回归中，我们被限制使用原始特征𝑥1, 𝑥2, . . . , 𝑥𝑛(或一些二项式来组合特征)</li>
</ul>
<h3 id="单层神经元"><a class="markdownIt-Anchor" href="#单层神经元"></a> 单层神经元</h3>
<img src="/MyImages/image-20200406190201011.png" alt="image-20200406190201011" style="zoom: 67%;" />
<ul>
<li>可以表示逻辑运算，比如与、或</li>
</ul>
<h4 id="and函数"><a class="markdownIt-Anchor" href="#and函数"></a> AND函数</h4>
<img src="/MyImages/image-20200406191740550.png" alt="image-20200406191740550" style="zoom:67%;" />
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mo>−</mo><mn>30</mn><mo>+</mo><mn>20</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>20</mn><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_\theta(x)=g(-30+20x_1+20x_2)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">−</span><span class="mord">3</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>其中g是sigmod函数</p>
<img src="/MyImages/image-20200406190435864.png" alt="image-20200406190435864" style="zoom:67%;" />
<h4 id="or函数"><a class="markdownIt-Anchor" href="#or函数"></a> OR函数</h4>
<img src="/MyImages/image-20200406191755997.png" alt="image-20200406191755997" style="zoom:67%;" />
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mo>−</mo><mn>10</mn><mo>+</mo><mn>20</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>20</mn><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_\theta(x)=g(-10+20x_1+20x_2)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<img src="/MyImages/image-20200406190700068.png" alt="image-20200406190700068" style="zoom:67%;" />
<h4 id="not函数"><a class="markdownIt-Anchor" href="#not函数"></a> NOT函数</h4>
<img src="/MyImages/image-20200406191000700.png" alt="image-20200406191000700" style="zoom:67%;" />
<h1 id="样本和直观理解ii"><a class="markdownIt-Anchor" href="#样本和直观理解ii"></a> 样本和直观理解II</h1>
<h2 id="实现一个xnor功能"><a class="markdownIt-Anchor" href="#实现一个xnor功能"></a> 实现一个XNOR功能</h2>
<p>XNOR = (x1 ANDx2) OR((NOT x1)AND(NOT x2))</p>
<ul>
<li>
<p>首先构造一个能表达(NOT x1)AND(NOT x2)部分的神经元：</p>
<img src="/MyImages/image-20200406191114110.png" alt="image-20200406191114110" style="zoom: 67%;" />
</li>
<li>
<p>然后将表示 <strong>AND</strong> 的神经元和表示(NOT x1)AND(NOT x2)的神经元以及表示 OR 的神经元进行组合：</p>
<img src="/MyImages/image-20200406191402311.png" alt="image-20200406191402311" style="zoom:67%;" />
</li>
</ul>
<h1 id="多类分类"><a class="markdownIt-Anchor" href="#多类分类"></a> 多类分类</h1>
<ul>
<li>
<p>输出层有多个值，但是对于分类问题，输出的列向量中只会有一个为1</p>
</li>
<li>
<p>不如要分类人、汽车、摩托车和卡车</p>
<img src="/MyImages/image-20200406203845358.png" alt="image-20200406203845358" style="zoom:67%;" />
<p>输出结果为四种可能情形之一：</p>
<img src="/MyImages/image-20200406203903526.png" alt="image-20200406203903526" style="zoom:67%;" /></li>
</ul>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hide/" rel="tag">hide</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-9神经网络学习" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/06/30/9%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/"
    >9神经网络学习</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/06/30/9%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0/" class="article-date">
  <time datetime="2020-06-30T15:22:17.779Z" itemprop="datePublished">2020-06-30</time>
</a>
      
      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h1 id="代价函数"><a class="markdownIt-Anchor" href="#代价函数"></a> 代价函数</h1>
<img src="/MyImages/image-20200409111224222.png" alt="image-20200409111224222" style="zoom:67%;" />
<ul>
<li>
<p>对于每一行特征，都会给出K个预测，在K的预测中选择可能性最高的一个作为预测的分类</p>
</li>
<li>
<p>最后一项为正则化项。正则化的那一项只是排除了每一层𝜃0后，每一层的𝜃 矩阵的和。最里层的循环𝑗循环所有的行（由𝑠𝑙 +1 层的激活单元数决定），循环𝑖则循环所有的列，由该层（𝑠𝑙层）的激活单</p>
<p>元数所决定。即：ℎ𝜃(𝑥)与真实值之间的距离为每个样本-每个类输出的加和，对参数进行<strong>regularization</strong> 的 <strong>bias</strong> 项处理所有参数的平方和。</p>
</li>
</ul>
<h1 id="反向传播算法"><a class="markdownIt-Anchor" href="#反向传播算法"></a> 反向传播算法</h1>
<ul>
<li>目的是计算$$\frac{\alpha}{\alpha\theta_{ij}^{(l)}}J(\theta)$$</li>
<li>首先计算最后一层的误差，然后再一层一层反向求出各层的误差，知道导数第二层</li>
</ul>
<h2 id="举例"><a class="markdownIt-Anchor" href="#举例"></a> 举例</h2>
<ul>
<li>
<p>假设已知一个四层的神经网络，其中K=4,S<sub>L</sub>=4,L=4</p>
</li>
<li>
<p>前向传播得到</p>
<img src="/MyImages/image-20200409112541529.png" alt="image-20200409112541529" style="zoom:50%;" />
</li>
<li>
<p>然后反向传播计算误差</p>
<ul>
<li>
<p>计算最后一层的误差，𝛿(4) = 𝑎(4) − 𝑦</p>
</li>
<li>
<p class='katex-block katex-error' title='ParseError: KaTeX parse error: Can&#039;t use function &#039;$&#039; in math mode at position 38: …) ∗ 𝑔′(𝑧(3)) $̲$其中

* 𝑔′(𝑧(3…'>𝛿(3) = (𝛩(3))^𝑇𝛿(4) ∗ 𝑔′(𝑧(3)) $$其中

* 𝑔′(𝑧(3)) = 𝑎(3) ∗ (1 − 𝑎(3))
* $$(𝜃(3))^𝑇𝛿(4)$$是权重导致的误差的和

</p>
</li>
<li>
<p>第一层是输入变量，不存在误差。假设𝜆 = 0，即我们不做任何正则化处理时有：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>α</mi><mrow><mi>α</mi><msubsup><mi>θ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow></mfrac><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mi>a</mi><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><msubsup><mi>δ</mi><mi>i</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\frac{\alpha}{\alpha\theta_{ij}^{(i)}}J(\theta)=a_j^{(l)}\delta_i^{l+1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4553320000000003em;vertical-align:-1.347772em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.2748em;"><span class="pstrut" style="height:3.0448em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7218em;"><span class="pstrut" style="height:3.0448em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.0037em;">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.347772em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathdefault" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-0.412972em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999998em;"><span style="top:-2.433005em;margin-left:-0.03785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.266995em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>𝑙 代表目前所计算的是第几层。</li>
<li>𝑗 代表目前计算层中的激活单元的下标，也将是下一层的第𝑗个输入变量的下标。</li>
<li>𝑖 代表下一层中误差单元的下标，是受到权重矩阵中第𝑖行影响的下一层中的误差单元的下标</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="考虑正则化处理"><a class="markdownIt-Anchor" href="#考虑正则化处理"></a> 考虑正则化处理</h2>
<ul>
<li>
<p>如果我们考虑正则化处理，并且我们的训练集是一个特征矩阵而非向量。在上面的特殊情况中，我们需要计算每一层的误差单元来计算代价函数的偏导数。在更为一般的情况中，我们同样需要计算每一层的误差单元，但是我们需要为整个训练集计算误差单元，此时的误差单元也是一个矩阵，用$$Δ_{ij}^{(l)}$$来表示第l层的第i个激活单元收到第j个参数影响而导致的误差</p>
</li>
<li>
<p><img src="/MyImages/image-20200409115010301.png" alt="image-20200409115010301" /></p>
</li>
<li>
<p>求出$$Δ_{ij}^{(l)}$$后，计算代价函数的偏导数</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>:</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msub><mi mathvariant="normal">Δ</mi><mrow><mi>i</mi><msup><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup></mrow></msub><mo>+</mo><mi>λ</mi><msubsup><mi>θ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><mi>i</mi><mi>f</mi><mi>k</mi><mi mathvariant="normal">≠</mi><mn>0</mn><mspace linebreak="newline"></mspace><msubsup><mi>D</mi><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msubsup><mo>:</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msub><mi mathvariant="normal">Δ</mi><mrow><mi>i</mi><msup><mi>j</mi><mrow><mo stretchy="false">(</mo><mi>l</mi><mo stretchy="false">)</mo></mrow></msup></mrow></msub><mi>i</mi><mi>f</mi><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">D_{ij}^{(l)}:\frac{1}{m}Δ_{ij^{(l)}}+\lambda\theta_{ij}^{(l)} if k \neq0\\
D_{ij}^{(l)}:\frac{1}{m}Δ_{ij^{(l)}}if k =0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-0.412972em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4693750000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.366733em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-0.412972em;"></span><span class="mord mathdefault">λ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.4577719999999998em;vertical-align:-0.412972em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.4693750000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.366733em;"><span></span></span></span></span></span></span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span></p>
</li>
</ul>
<h1 id="杂记"><a class="markdownIt-Anchor" href="#杂记"></a> 杂记</h1>
<h2 id="静态系统-动态系统"><a class="markdownIt-Anchor" href="#静态系统-动态系统"></a> 静态系统 &amp; 动态系统</h2>
<ul>
<li>静态系统与历史状态无关，没有记忆能力</li>
<li>动态系统与历史状态有关，一个系统中只要有部分是动态的，那么整个系统就是动态的</li>
</ul>
<h2 id="反向传播"><a class="markdownIt-Anchor" href="#反向传播"></a> 反向传播</h2>
<ul>
<li>
<p>目标函数$$E_p(W)=\frac{1}{2}\sum_k(y_k-O_k<sup>M)</sup>2$$</p>
</li>
<li>
<p>更新权重<img src="/MyImages/image-20200424215640128.png" alt="image-20200424215640128" style="zoom: 50%;" /></p>
</li>
<li>
<p>求偏导<img src="/MyImages/image-20200424215706733.png" alt="image-20200424215706733" style="zoom: 50%;" /></p>
</li>
<li>
<p>误差对第k层第j个神经元的偏导</p>
<img src="/MyImages/image-20200424215855262.png" alt="image-20200424215855262" style="zoom: 50%;" />
</li>
</ul>
<h3 id="加速学习img-srcmyimagesimage-20200424224548636png-altimage-20200424224548636-stylezoom67"><a class="markdownIt-Anchor" href="#加速学习img-srcmyimagesimage-20200424224548636png-altimage-20200424224548636-stylezoom67"></a> 加速学习<img src="/MyImages/image-20200424224548636.png" alt="image-20200424224548636" style="zoom:67%;" /></h3>
<ul>
<li>第二项就好像加上一个惯性</li>
</ul>
<h3 id="顺序与批量梯度下降"><a class="markdownIt-Anchor" href="#顺序与批量梯度下降"></a> 顺序与批量梯度下降</h3>
<ul>
<li>顺序模型是指
<ul>
<li>计算速度更快</li>
<li>更适合大型数据集</li>
<li>使权值空间的搜索具有随机性</li>
<li>更不容易陷入到局部极小值</li>
<li>较难建立算法收敛的理论条件</li>
</ul>
</li>
</ul>
<h3 id="学习结束标志"><a class="markdownIt-Anchor" href="#学习结束标志"></a> 学习结束标志</h3>
<ul>
<li>梯度向量
<ul>
<li>当梯度向量的欧几里德范数达到一个足够小的梯度阈值时结束</li>
</ul>
</li>
<li>错误减少
<ul>
<li>如果两代之间的误差的减少量很小，那么可以停止学习</li>
</ul>
</li>
<li>泛化性能
<ul>
<li>当泛化性能到达顶点的时候结束</li>
</ul>
</li>
</ul>
<h3 id="隐藏神经元数目取决于"><a class="markdownIt-Anchor" href="#隐藏神经元数目取决于"></a> 隐藏神经元数目取决于</h3>
<ul>
<li>训练样本数量</li>
<li>输入输出神经元数量</li>
<li>噪声和数据质量</li>
<li>要学习的问题的复杂程度</li>
<li>激活函数的形式</li>
<li>学习算法</li>
</ul>
<p>隐藏神经元数太少，导致误差很大；隐藏神经元太多，会导致模型自由度大，参数多，学习慢，得到的模型也更可能出现过拟合</p>
<h3 id="学-习"><a class="markdownIt-Anchor" href="#学-习"></a> 学 &amp; 习</h3>
<ul>
<li>学：和别人学，是有监督的</li>
<li>习：是自己悟，是无监督的</li>
</ul>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hide/" rel="tag">hide</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/">上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/3/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2015-2020
        CuiEnbo
      </li>
      <li>
        
        Powered by
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
      </li>
      
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt=""></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script>
  try {
    var typed = new Typed("#subtitle", {
      strings: ['', '', ''],
      startDelay: 0,
      typeSpeed: 200,
      loop: true,
      backSpeed: 100,
      showCursor: false
    });
  } catch (err) {
  }

</script>





<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>



<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true
  }
</script>



<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>

    
  </div>
</body>

</html>